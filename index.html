<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>恐竜販売コピー生成</title>
<style>
  body { font-family: -apple-system, BlinkMacSystemFont, sans-serif; margin:0; padding:10px; }
  h3 { margin: 6px 0 10px; }
  .row { border-bottom: 1px solid #e5e5e5; padding: 10px 0; }
  .name { font-weight: 700; font-size: 15px; }
  .line { display:flex; gap:8px; align-items:center; flex-wrap:wrap; margin-top:8px; }
  select { font-size: 15px; padding: 6px; }
  .sex { display:flex; align-items:center; gap:6px; }
  .badge { font-size: 13px; padding: 2px 6px; border-radius: 8px; background:#f2f2f2; }
  .btn { width: 36px; height: 36px; font-size: 20px; border-radius: 10px; border: 1px solid #ccc; background: #fff; }
  .count { min-width: 22px; text-align:center; font-size: 18px; font-variant-numeric: tabular-nums; }
  button.main { width:100%; padding: 12px; font-size: 16px; margin-top: 10px; border-radius: 12px; border:1px solid #ccc; background:#fff; }
  textarea { width:100%; height: 240px; margin-top: 10px; font-size: 13px; padding:10px; border-radius: 12px; border:1px solid #ccc; }
  .hint { color:#666; font-size:12px; margin-top:6px; }
</style>
</head>
<body>

<h3>🦖 恐竜販売コピー生成</h3>
<div class="hint">
・±で入力（数字直入力なし）<br>
・「受精卵(指定) / 胚(指定) / 幼体 / 成体」は♂♀表記<br>
・それ以外は合算して「受精卵×2」形式（受精卵のみペア特例あり）
</div>

<div id="list"></div>

<button class="main" onclick="generate()">コピー文を生成</button>
<textarea id="result" readonly placeholder="ここに生成結果が出ます"></textarea>
<button class="main" onclick="copyText()">コピーする</button>

<script>
const prices = {
  "受精卵": 30,
  "受精卵(指定)": 50,
  "幼体": 100,
  "胚": 50,
  "胚(指定)": 100,
  "成体": 500
};

const sexTypes = new Set(["受精卵(指定)", "胚(指定)", "幼体", "成体"]);

const dinos = [
"TEKギガノト",
"TEKケツァル",
"TEKティラノサウルス",
"アーケロン",
"アースロプレウラ",
"アイスワイバーン",
"アルゲン",
"アルマドッゴ",
"アロサウルス",
"アンキロサウルス",
"アンコウ",
"イーリン",
"オヴィラプトル",
"オリジナルカスタムレシピ",
"カストロイデス",
"ガスバッグ",
"ガチャクローン",
"ガチャクローン全種",
"カマキリ",
"カルカロ",
"カルカロ Lv1クローン",
"カルキノス",
"カルノタウルス変種",
"カルボネミス",
"カワウソ変種",
"ギガノト",
"ギガントラプトル",
"グリフィン",
"ケラトサウルス",
"コスモ",
"サルコスクス",
"シファクティヌス",
"ステゴサウルス",
"スピノサウルス変種",
"ダイアベア",
"ダエオドン",
"ダンクル",
"デイノスクス",
"デイノテリウム",
"デイノニクス",
"ティラコレオ",
"ティラノサウルス",
"デフォルトカスタムレシピ",
"テリジノ",
"トゥソ",
"ドエディクルス変種",
"ドードー",
"ドレイクリング(夏)",
"ドレイクリング(秋)",
"ドレイクリング(春)",
"ドレイクリング(冬)",
"ドレッドノータス",
"ドレッドメア",
"バイソン",
"パイロメイン",
"ハゲワシ",
"バジリスク",
"バシロサウルス",
"ハチ",
"バリオニクス変種",
"バルブドッグ",
"ヒエノドン",
"ヒツジ",
"ファイアワイバーン",
"ファソラスクス",
"フェザーライト",
"プテラノドン",
"プロコプトドン",
"ブロントサウルス",
"フンコロガシ",
"ベールウィン",
"ベールゼブフォ",
"ペゴマスタクス",
"ヘスペロルニス",
"ペラゴルニス",
"ヘリコプリオン",
"ベロナサウルス",
"マナガルム",
"マンモス",
"メイグアナ",
"メガテリウム",
"メガラニア",
"メガロサウルス変種",
"メガロドン",
"モササウルス",
"ユウティラヌス",
"ユニコーン",
"ライトニングワイバーン",
"ラベジャー",
"リマントリア",
"ロックドレイク",
"雪フクロウ"
];

const list = document.getElementById("list");

function rowTemplate(name) {
  const div = document.createElement("div");
  div.className = "row";
  div.innerHTML = `
    <div class="name">${name}</div>
    <div class="line">
      <span class="badge">タイプ</span>
      <select class="type">
        <option>受精卵</option>
        <option>受精卵(指定)</option>
        <option>幼体</option>
        <option>胚</option>
        <option>胚(指定)</option>
        <option>成体</option>
      </select>

      <div class="sex">
        <span class="badge">♂</span>
        <button class="btn" type="button" onclick="chg(this,-1,'m')">−</button>
        <span class="count m">0</span>
        <button class="btn" type="button" onclick="chg(this,1,'m')">＋</button>
      </div>

      <div class="sex">
        <span class="badge">♀</span>
        <button class="btn" type="button" onclick="chg(this,-1,'f')">−</button>
        <span class="count f">0</span>
        <button class="btn" type="button" onclick="chg(this,1,'f')">＋</button>
      </div>
    </div>
  `;
  return div;
}

dinos.forEach(d => list.appendChild(rowTemplate(d)));

function chg(btn, delta, sex) {
  const row = btn.closest(".row");
  const el = row.querySelector("." + sex);
  let v = Number(el.textContent);
  v = Math.max(0, v + delta);
  el.textContent = v;
}

function formatLine(type, m, f) {
  const qty = m + f;

  // ♂♀表記タイプ
  if (sexTypes.has(type)) {
    const parts = [];
    if (m > 0) parts.push(`♂×${m}`);
    if (f > 0) parts.push(`♀×${f}`);
    return `${type} ${parts.join(" ")}`;
  }

  // ♂♀区別なしタイプ（合算）
  if (type === "受精卵" && m === f && m > 0) {
    return `受精卵ペア${m > 1 ? "×" + m : ""}`;
  }

  return `${type}×${qty}`;
}

function generate() {
  let lines = [];
  let total = 0;
  let idx = 1;

  document.querySelectorAll(".row").forEach(row => {
    const name = row.querySelector(".name").textContent;
    const type = row.querySelector(".type").value;
    const m = Number(row.querySelector(".m").textContent);
    const f = Number(row.querySelector(".f").textContent);
    const qty = m + f;

    if (qty === 0) return;

    const unit = prices[type] ?? 0;
    const price = unit * qty;

    const label = formatLine(type, m, f);

    total += price;
    lines.push(`${idx}. ${name} ${label} = ${price}円`);
    idx++;
  });

  document.getElementById("result").value =
`この度はご検討いただきありがとうございます！
ご希望内容は以下となります👇🏻

${lines.join("\n")}
ーーーーーーーーーーーーーーー
計：${total}円
最短納品目安 : 即納品可能

ご希望内容、金額をご確認の上購入の方よろしくお願いします🙏🏻

また、追加や変更などありましたら、お気軽にお申し付けください👍🏻`;
}

async function copyText() {
  const text = document.getElementById("result").value;
  if (!text) return alert("先にコピー文を生成してください。");
  try {
    await navigator.clipboard.writeText(text);
    alert("コピーしました");
  } catch (e) {
    alert("コピーできませんでした。iOSの制限で失敗する場合は、文章を長押し→全選択→コピーしてください。");
  }
}
</script>

</body>
</html>
