<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>æç«œè²©å£²ã‚³ãƒ”ãƒ¼ç”Ÿæˆ</title>
<style>
  body { font-family: -apple-system, BlinkMacSystemFont, "Helvetica Neue", Arial, sans-serif; padding: 20px; }
  select, input, button { margin: 6px 0; padding: 10px; font-size: 16px; }
  textarea { width: 100%; height: 240px; margin-top: 10px; font-size: 14px; }
  .item { border-bottom: 1px solid #ddd; padding: 12px 0; margin-bottom: 10px; }
  .row { display: flex; gap: 8px; flex-wrap: wrap; align-items: center; }
  .row > * { flex: 1 1 auto; }
</style>
</head>
<body>

<h2>ğŸ¦– æç«œè²©å£²ã‚³ãƒ”ãƒ¼ç”Ÿæˆ</h2>

<div id="items"></div>

<div class="row">
  <button onclick="addItem()">ï¼‹æç«œã‚’è¿½åŠ </button>
  <button onclick="generate()">ã‚³ãƒ”ãƒ¼æ–‡ã‚’ç”Ÿæˆ</button>
</div>

<textarea id="result" readonly placeholder="ã“ã“ã«ç”ŸæˆçµæœãŒå‡ºã¾ã™"></textarea>

<button onclick="copyText()">ğŸ“‹ ã‚³ãƒ”ãƒ¼ã™ã‚‹</button>

<script>
const prices = {
  "å—ç²¾åµ": 30,
  "å—ç²¾åµ(æŒ‡å®š)": 50,
  "å¹¼ä½“": 100,
  "èƒš": 50,
  "èƒš(æŒ‡å®š)": 100,
  "æˆä½“": 500
};

function addItem() {
  const div = document.createElement("div");
  div.className = "item";
  div.innerHTML = `
    <div class="row">
      <label>æç«œå</label>
      <input class="dinoName" type="text" placeholder="TEKã‚®ã‚¬ãƒãƒˆ">
    </div>
    <div class="row">
      <label>çŠ¶æ…‹</label>
      <select class="dinoType">
        <option>å—ç²¾åµ</option>
        <option>å—ç²¾åµ(æŒ‡å®š)</option>
        <option>å¹¼ä½“</option>
        <option>èƒš</option>
        <option>èƒš(æŒ‡å®š)</option>
        <option>æˆä½“</option>
      </select>
    </div>
    <div class="row">
      <label>æ•°é‡</label>
      <input class="dinoQty" type="number" value="1" min="1" inputmode="numeric">
    </div>
  `;
  document.getElementById("items").appendChild(div);
}

function generate() {
  const items = document.querySelectorAll(".item");
  let total = 0;
  let lines = [];
  let index = 1;

  for (const item of items) {
    const name = item.querySelector(".dinoName").value.trim();
    const type = item.querySelector(".dinoType").value;
    const qty = Number(item.querySelector(".dinoQty").value);

    if (!name) continue;                 // ç©ºè¡Œã¯ç„¡è¦–
    if (!Number.isFinite(qty) || qty < 1) continue;

    const price = prices[type] * qty;
    total += price;
    lines.push(`${index}. ${name}${type}Ã—${qty} = ${price}å††`);
    index++;
  }

  if (lines.length === 0) {
    alert("å°‘ãªãã¨ã‚‚1ã¤ã€æç«œåã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚");
    return;
  }

  const text =
`ã“ã®åº¦ã¯ã”æ¤œè¨ã„ãŸã ãã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ï¼
ã”å¸Œæœ›å†…å®¹ã¯ä»¥ä¸‹ã¨ãªã‚Šã¾ã™ğŸ‘‡ğŸ»

${lines.join("\n")}
ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼
è¨ˆï¼š${total}å††
æœ€çŸ­ç´å“ç›®å®‰ : å³ç´å“å¯èƒ½

ã”å¸Œæœ›å†…å®¹ã€é‡‘é¡ã‚’ã”ç¢ºèªã®ä¸Šè³¼å…¥ã®æ–¹ã‚ˆã‚ã—ããŠé¡˜ã„ã—ã¾ã™ğŸ™ğŸ»

ã¾ãŸã€è¿½åŠ ã‚„å¤‰æ›´ãªã©ã‚ã‚Šã¾ã—ãŸã‚‰ã€ãŠæ°—è»½ã«ãŠç”³ã—ä»˜ã‘ãã ã•ã„ğŸ‘ğŸ»`;

  document.getElementById("result").value = text;
}

async function copyText() {
  const t = document.getElementById("result");
  const text = t.value;

  if (!text) { alert("å…ˆã«ã€Œã‚³ãƒ”ãƒ¼æ–‡ã‚’ç”Ÿæˆã€ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚"); return; }

  // iOS Safariã§ã®å®‰å®šå„ªå…ˆï¼šClipboard API â†’ ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
  try {
    if (navigator.clipboard && window.isSecureContext) {
      await navigator.clipboard.writeText(text);
    } else {
      t.focus();
      t.select();
      t.setSelectionRange(0, t.value.length);
      document.execCommand("copy");
    }
    alert("ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼");
  } catch (e) {
    alert("ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸã€‚Safariã§é–‹ã„ã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„
