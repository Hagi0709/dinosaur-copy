<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport"
  content="width=device-width,
           initial-scale=1,
           maximum-scale=1,
           user-scalable=no,
           viewport-fit=cover">

<title>ÊÅêÁ´úË≤©Â£≤„Ç≥„Éî„ÉºÁîüÊàê</title>

<link rel="icon" href="56379E4F-8771-431A-B2A6-4B3EE3136504.png">
<link rel="apple-touch-icon" href="56379E4F-8771-431A-B2A6-4B3EE3136504.png">

<style>
:root{
  --bg:#0b0f14;
  --txt:rgba(255,255,255,.92);
  --mut:rgba(255,255,255,.60);
  --male:#74d7ff;
  --female:#ff86c8;
  --ok:#78ffb3;
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,system-ui,sans-serif;
  background:var(--bg);
  color:var(--txt);
  padding-bottom:120px;
}
button,select,input{touch-action:manipulation}

/* ===== top ===== */
.top{
  position:sticky;
  top:0;
  z-index:10;
  background:rgba(11,15,20,.95);
  backdrop-filter:blur(14px);
  padding:10px;
  padding-top:calc(10px + env(safe-area-inset-top));
  border-bottom:1px solid rgba(255,255,255,.06);
}
.row{
  display:flex;
  gap:8px;
  align-items:center;
  flex-wrap:wrap;
}
.search{
  flex:1;
  display:flex;
  align-items:center;
  gap:8px;
  height:36px;
  padding:0 10px;
  border-radius:14px;
  background:rgba(255,255,255,.07);
  border:1px solid rgba(255,255,255,.12);
}
.search input{
  flex:1;
  border:0;
  background:transparent;
  color:var(--txt);
  font-size:14px;
}
.qClear{
  width:26px;height:26px;
  border-radius:999px;
  border:1px solid rgba(255,255,255,.14);
  background:rgba(255,255,255,.06);
  font-size:18px;
  color:#fff;
  display:inline-block;
}
.delivery,.copy{
  height:36px;
  border-radius:14px;
  border:1px solid rgba(255,255,255,.14);
  background:rgba(255,255,255,.08);
  color:#fff;
  padding:0 12px;
}
.copy{font-weight:900}
.total{
  margin-left:auto;
  font-size:14px;
  color:var(--ok);
  font-weight:900;
  white-space:nowrap;
}
textarea{
  width:100%;
  margin-top:8px;
  height:120px;
  border-radius:14px;
  border:1px solid rgba(255,255,255,.12);
  background:rgba(0,0,0,.22);
  color:#fff;
  padding:10px;
  font-size:12px;
  line-height:1.45;
}

/* ===== list ===== */
.list{padding:12px}
.card{
  background:linear-gradient(180deg,rgba(255,255,255,.10),rgba(255,255,255,.06));
  border:1px solid rgba(255,255,255,.10);
  border-radius:16px;
  padding:12px;
  margin-bottom:10px;
}
.card.collapsed .body{display:none}

.head{
  display:flex;
  justify-content:space-between;
  align-items:flex-start;
  gap:10px;
  cursor:pointer;
}
.name{font-weight:900}
.right{
  text-align:right;
  display:flex;
  flex-direction:column;
  gap:4px;
}
select.type{
  padding:6px 10px;
  border-radius:999px;
  background:rgba(255,255,255,.08);
  border:1px solid rgba(255,255,255,.14);
  color:#fff;
  font-size:12px;
}
.unit{font-size:12px;color:var(--mut)}

.body{margin-top:10px}
.sexrow{
  display:flex;
  gap:10px;
}
.sex{
  flex:1;
  padding:8px;
  border-radius:14px;
  border:2px solid rgba(255,255,255,.10);
}
.sex.m{border-color:rgba(116,215,255,.45);background:rgba(116,215,255,.14)}
.sex.f{border-color:rgba(255,134,200,.45);background:rgba(255,134,200,.14)}

.stepper{
  display:flex;
  align-items:center;
  gap:10px;
}
.btn{
  width:46px;
  height:32px;
  border-radius:12px;
  border:1px solid rgba(255,255,255,.14);
  background:rgba(255,255,255,.10);
  color:#fff;
  font-size:18px;
  font-weight:900;
}
.val{
  flex:1;
  text-align:center;
  font-weight:900;
  font-size:16px;
}
</style>
</head>

<body>

<div class="top">
  <div class="row">
    <div class="search">
      <input id="q" placeholder="Ê§úÁ¥¢">
      <button id="qClear" class="qClear">√ó</button>
    </div>
    <select id="delivery" class="delivery">
      <option value="Âç≥Á¥çÂìÅÂèØËÉΩ">Âç≥Á¥çÂìÅÂèØËÉΩ</option>
      <option value="Êú¨Êó•Â§ú">Êú¨Êó•Â§ú</option>
    </select>
    <button id="copy" class="copy">„Ç≥„Éî„Éº</button>
    <div id="total" class="total">0ÂÜÜ</div>
  </div>
  <textarea id="out" readonly></textarea>
</div>

<div class="list" id="list"></div>

<script>
const prices={
  "ÂèóÁ≤æÂçµ":30,"ÂèóÁ≤æÂçµ(ÊåáÂÆö)":50,
  "Âπº‰Ωì":100,"ËÉö":50,"ËÉö(ÊåáÂÆö)":100,
  "Êàê‰Ωì":500,"„ÇØ„É≠„Éº„É≥":500,"„ÇØ„É≠„Éº„É≥(ÊåáÂÆö)":300
};
const pairBase=new Set(["ÂèóÁ≤æÂçµ","ËÉö","Âπº‰Ωì","Êàê‰Ωì","„ÇØ„É≠„Éº„É≥"]);

const dinos=[], state=new Map();
const listEl=document.getElementById("list");
const outEl=document.getElementById("out");
const totalEl=document.getElementById("total");
const qEl=document.getElementById("q");
const qClear=document.getElementById("qClear");
const delivery=document.getElementById("delivery");

/* ===== search utils ===== */
function kataToHira(str){
  return (str||"").replace(/[\u30a1-\u30f6]/g,ch =>
    String.fromCharCode(ch.charCodeAt(0)-0x60)
  );
}
function norm(str){
  return kataToHira(str).replace(/[ „ÄÄ„Éª]/g,"");
}

/* ===== rebuild (Âá∫ÂäõÂ∞ÇÁî®) ===== */
function rebuild(){
  let sum=0, lines=[], idx=1;

  dinos.forEach(name=>{
    const s=state.get(name);
    const qty=s.m+s.f;
    if(qty===0) return;

    const price=(prices[s.type]||0)*qty;
    sum+=price;

    const t=s.type.replace("(ÊåáÂÆö)","");
    let line="";
    if(pairBase.has(t)){
      if(s.m===s.f){
        line=`${name}${t}„Éö„Ç¢${s.m>1?"√ó"+s.m:""} = ${price.toLocaleString("ja-JP")}ÂÜÜ`;
      }else{
        const p=[];
        if(s.m>0)p.push(`‚ôÇ√ó${s.m}`);
        if(s.f>0)p.push(`‚ôÄ√ó${s.f}`);
        line=`${name}${t} ${p.join(" ")} = ${price.toLocaleString("ja-JP")}ÂÜÜ`;
      }
    }else{
      line=`${name}${t}√ó${qty} = ${price.toLocaleString("ja-JP")}ÂÜÜ`;
    }
    lines.push(`${idx}. ${line}`);
    idx++;
  });

  totalEl.textContent=sum.toLocaleString("ja-JP")+"ÂÜÜ";
  outEl.value=
`„Åì„ÅÆÂ∫¶„ÅØ„ÅîÊ§úË®é„ÅÑ„Åü„Å†„Åç„ÅÇ„Çä„Åå„Å®„ÅÜ„Åî„Åñ„ÅÑ„Åæ„ÅôÔºÅ
„ÅîÂ∏åÊúõÂÜÖÂÆπ„ÅØ‰ª•‰∏ã„Å®„Å™„Çä„Åæ„Åôüëáüèª

${lines.join("\n")}
„Éº„Éº„Éº„Éº„Éº„Éº„Éº„Éº„Éº„Éº„Éº„Éº„Éº„Éº„Éº
Ë®àÔºö${sum.toLocaleString("ja-JP")}ÂÜÜ
ÊúÄÁü≠Á¥çÂìÅÁõÆÂÆâ : ${delivery.value}`;
}

/* ===== search ===== */
function applySearch(){
  const q=norm(qEl.value);
  dinos.forEach(name=>{
    const s=state.get(name);
    s.card.style.display = (!q || s.normName.includes(q)) ? "" : "none";
  });
}
qEl.oninput=applySearch;
qClear.onclick=()=>{qEl.value="";applySearch();};

/* ===== load ===== */
async function load(){
  const text=await fetch("dinos.txt?ts="+Date.now()).then(r=>r.text());
  text.split(/\r?\n/).forEach(line=>{
    if(!line.trim())return;
    const name=line.replace(/^„Éª/,"").split("|")[0].trim();
    const defType=(line.split("|")[1]||"ÂèóÁ≤æÂçµ").trim();

    dinos.push(name);
    const baseType=defType.replace("(ÊåáÂÆö)","");
    const s={type:defType,baseType,m:0,f:0,normName:norm(name)};
    state.set(name,s);

    const card=document.createElement("div");
    s.card=card;
    card.className="card collapsed";
    card.innerHTML=`
      <div class="head">
        <div class="name">${name}</div>
        <div class="right">
          <select class="type">${Object.keys(prices).map(t=>`<option>${t}</option>`).join("")}</select>
          <div class="unit"></div>
        </div>
      </div>
      <div class="body">
        <div class="sexrow">
          <div class="sex m">
            <div class="stepper">
              <button class="btn" data-sex="m" data-d="-1">‚àí</button>
              <div class="val mc">0</div>
              <button class="btn" data-sex="m" data-d="1">Ôºã</button>
            </div>
          </div>
          <div class="sex f">
            <div class="stepper">
              <button class="btn" data-sex="f" data-d="-1">‚àí</button>
              <div class="val fc">0</div>
              <button class="btn" data-sex="f" data-d="1">Ôºã</button>
            </div>
          </div>
        </div>
      </div>`;
    listEl.appendChild(card);

    const sel=card.querySelector(".type");
    const unit=card.querySelector(".unit");
    const mc=card.querySelector(".mc");
    const fc=card.querySelector(".fc");

    sel.value=s.type;
    unit.textContent=`Âçò‰æ°${prices[s.type]}ÂÜÜ`;

    card.querySelector(".head").onclick=()=>{
      card.classList.toggle("collapsed");
    };

    sel.onchange=()=>{
      s.type=sel.value;
      s.baseType=s.type.replace("(ÊåáÂÆö)","");
      unit.textContent=`Âçò‰æ°${prices[s.type]}ÂÜÜ`;
      rebuild();
    };

    card.querySelectorAll(".btn").forEach(b=>{
      b.onclick=()=>{
        const sex=b.dataset.sex;
        s[sex]=Math.max(0,s[sex]+Number(b.dataset.d));
        mc.textContent=s.m;
        fc.textContent=s.f;

        if(s.m>0 && s.f>0){
          const cand=s.baseType+"(ÊåáÂÆö)";
          if(prices[cand]) s.type=cand;
        }else if(s.m===0 && s.f===0){
          s.type=s.baseType;
        }
        sel.value=s.type;
        unit.textContent=`Âçò‰æ°${prices[s.type]}ÂÜÜ`;
        rebuild();
      };
    });
  });

  rebuild();
}
load();
</script>

</body>
</html>